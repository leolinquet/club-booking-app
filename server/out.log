Manager account already exists: leolinquet
server listening on :5051
DELETE /clubs/:clubId/sports/:id auth check {
  clubId: 3,
  id: 2,
  managerIdProvided: 4,
  body: { userId: 4 },
  query: {}
}
isClubManager? { clubId: 3, userId: 4, ok: true }
isClubManager result { ok: true }
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 1
DEBUG availability: sample bookings [
  {
    id: 6,
    court_index: '3',
    time: '10:00',
    user_id: 2,
    booked_by: 'user1',
    _starts_at: 2025-09-22T10:00:00.000Z
  }
]
DEBUG availability response sample for {
  clubId: 3,
  sport: 'basketball',
  date: '2025-09-22',
  bookingsCount: 1,
  sample: {
    time: '10:00',
    courts: [ [Object], [Object], [Object], [Object], [Object], [Object] ]
  }
}
DELETE /clubs/:clubId/sports/:id auth check {
  clubId: 3,
  id: 3,
  managerIdProvided: 4,
  body: { userId: 4 },
  query: {}
}
isClubManager? { clubId: 3, userId: 4, ok: true }
isClubManager result { ok: true }
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 2,
  sport: 'tennis',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '10:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'volleyball',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'padel',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '10:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'volleyball',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'padel',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '10:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
POST /book payload: {
  clubId: 3,
  sport: 'padel',
  courtIndex: 1,
  date: '2025-09-22',
  time: '18:00',
  userId: 2,
  asUsername: undefined
}
POST /book payload: {
  clubId: 3,
  sport: 'padel',
  courtIndex: 1,
  date: '2025-09-22',
  time: '19:00',
  userId: 2,
  asUsername: undefined
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'volleyball',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'volleyball',
  date: '2025-09-21',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
POST /book payload: {
  clubId: 3,
  sport: 'volleyball',
  courtIndex: 1,
  date: '2025-09-21',
  time: '17:15',
  userId: 2,
  asUsername: undefined
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'volleyball',
  date: '2025-09-23',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-23',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'padel',
  date: '2025-09-23',
  bookingsCount: 0,
  sample: { time: '10:00', courts: [ [Object], [Object], [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-22',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
isClubManager? { clubId: 3, userId: 4, ok: true }
POST /clubs/:id/sports payload {
  clubId: 3,
  userId: 4,
  sport: 'tennis',
  courts: 2,
  openHour: 19,
  closeHour: 20,
  slotMinutes: 5
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-23',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 3
DEBUG availability: sample bookings [
  {
    id: 22,
    court_index: '1',
    time: '13:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T13:00:00.000Z
  },
  {
    id: 24,
    court_index: '2',
    time: '15:00',
    user_id: 6,
    booked_by: 'user3',
    _starts_at: 2025-09-23T15:00:00.000Z
  },
  {
    id: 28,
    court_index: '0',
    time: '08:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T08:00:00.000Z
  }
]
DEBUG availability response sample for {
  clubId: 3,
  sport: 'tennis',
  date: '2025-09-23',
  bookingsCount: 3,
  sample: { time: '19:00', courts: [ [Object], [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 0
DEBUG availability response sample for {
  clubId: 3,
  sport: 'soccer',
  date: '2025-09-23',
  bookingsCount: 0,
  sample: { time: '15:00', courts: [ [Object] ] }
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 3
DEBUG availability: sample bookings [
  {
    id: 22,
    court_index: '1',
    time: '13:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T13:00:00.000Z
  },
  {
    id: 24,
    court_index: '2',
    time: '15:00',
    user_id: 6,
    booked_by: 'user3',
    _starts_at: 2025-09-23T15:00:00.000Z
  },
  {
    id: 28,
    court_index: '0',
    time: '08:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T08:00:00.000Z
  }
]
DEBUG availability response sample for {
  clubId: 3,
  sport: 'tennis',
  date: '2025-09-23',
  bookingsCount: 3,
  sample: { time: '19:00', courts: [ [Object], [Object] ] }
}
POST /book payload: {
  clubId: 3,
  sport: 'tennis',
  courtIndex: 0,
  date: '2025-09-23',
  time: '19:00',
  userId: 5,
  asUsername: undefined
}
DEBUG legacy booking mapping: {
  clubId: 3,
  requestedSport: 'tennis',
  includeLegacyNull: true,
  sql: 'SELECT id FROM courts WHERE club_id = ? AND (sport = ? OR sport IS NULL) ORDER BY id ASC LIMIT 1 OFFSET ?'
}
booking check (legacy starts_at) {
  clubId: 3,
  clubTz3: 'UTC',
  requestedStart: '2025-09-23T19:00:00.000Z',
  requestedEnd: '2025-09-23T20:00:00.000Z',
  now: '2025-09-23T00:00:26.915Z',
  valid: true
}
DEBUG booking insert params: {
  clubId: 3,
  courtId: 36,
  startsAtISO: '2025-09-23T19:00:00.000Z',
  endsAtISO: '2025-09-23T20:00:00.000Z',
  targetUserId: 5
}
DEBUG availability: bookings columns: id,club_id,court_id,user_id,starts_at,ends_at
DEBUG availability: bookings count: 4
DEBUG availability: sample bookings [
  {
    id: 22,
    court_index: '1',
    time: '13:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T13:00:00.000Z
  },
  {
    id: 24,
    court_index: '2',
    time: '15:00',
    user_id: 6,
    booked_by: 'user3',
    _starts_at: 2025-09-23T15:00:00.000Z
  },
  {
    id: 28,
    court_index: '0',
    time: '08:00',
    user_id: 4,
    booked_by: 'leolinquet',
    _starts_at: 2025-09-23T08:00:00.000Z
  },
  {
    id: 37,
    court_index: '0',
    time: '19:00',
    user_id: 5,
    booked_by: 'user2',
    _starts_at: 2025-09-23T19:00:00.000Z
  }
]
DEBUG availability response sample for {
  clubId: 3,
  sport: 'tennis',
  date: '2025-09-23',
  bookingsCount: 4,
  sample: { time: '19:00', courts: [ [Object], [Object] ] }
}
